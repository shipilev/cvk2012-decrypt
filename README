Сначала лирическое отступление. Необходимость в этом проекте для меня была
откровением в том, что разработчики ЦВК-2012 есть страшные говнари:

 1. Ключ к запароленному RAR'у, в котором лежит пароль от blowfish'а -- это круто.
    Пароли одинаковой длины и как будто одинаковой энтропии. Толку от двух
    шифрований? Продолбали первый пароль -- второй сразу есть.
    Продолбали второй -- толку от первого?

 2. Продолжаем публиковать шифрованные протоколы даже после окончания выборов?
    Хороший ход, есть чем заняться программистам вечерком.

 3. OpenSSL? Не, не слышал. Возьмём левую либу, которая непонятно в какой форме свои
    аргументы обрабатывает. В конце концов, есть же стандартная JCE, в которой даже
    есть точный пример для blowfish!
      http://docs.oracle.com/javase/1.4.2/docs/guide/security/jce/JCERefGuide.html#BlowKeyEx

И только совершенно случайно увидел:
   https://twitter.com/xoposhiy/status/260479920663306242

...а порывшись в коде, обнаружил искомую либу (которую @xoposhiy прикрутил через
OMFG: Java -> IKVM -> C#, [подозрительно смотрю]). Минимальная тула для этой либы
представлена здесь.

Раскопки постфактум показывают, что:
 a. String-ключ конвертируется в byte[], предполагая, что мы в UTF-8
 b. От byte[] ключа берётся SHA-1, и получается ключ для дешифрования
 c. Blowfish работает в CBC, IV = 0
 d. Данные приходят в виде строчки, закодированной в hex (Base16).

Сочетание (a), (b) и (d) срывает крышу любому стандартному тулу.
Стыдно, товарищи. Стыдно!

------------------------------------------------------------------------------------
Как пользоваться:
------------------------------------------------------------------------------------

1. Скачиваем (параноики могут построить через "mvn clean install")
  https://github.com/shipilev/cvk2012-decrypt/blob/master/target/cvk2012-decrypt.jar

2. Сливаем архив с
    http://www.cvk2012.org/news/protokol_golosovaniya/?Year=2012
  Нам нужен только протокол голосования, ключи у нас уже захардкожены.

3. Распаковываем protocol.csv

4. Запускаем:
 $ java -jar cvk2012-decrypt.jar protocol.csv protocol-decrypted.csv

5. Смотрим в protocol-decrypted.csv

